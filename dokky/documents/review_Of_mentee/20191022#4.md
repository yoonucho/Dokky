## 1. 진행중 겪었던 모든것들 

### 1) 자격 증명 아이디와 비밀번호를 디비에서 불러들이는게 안전할까..?

aws rds도 하나의 서버인데, 그 서버에서 아이디와 비밀번호를 ec2쪽으로 가져와 aws 자격증명을 설정한다면..?

디비에서 데이터를 불러오다가 유출될수도있는거 아닌가? 이것을 암호화 한다고 해도 결국 언젠가는 털릴수도 있는 문제아닌가?

그렇다면 ec2 서버 자체에만 아이디와 비밀번호를 설정하는게 그나마 안전하다는 결론일거같아서.

리눅스 ec2에 aws cli를 설치후에 aws사용자 아이디와 비밀번호까지 설정해보았다.

하지만 ec2 자체도 털리수 있는일이 있지 않을까..? 무엇이 가장 안전할까..?

aws는 항상 과금때문에 걱정이고..조심스럽다..

### 2) 로컬인 내 pc에서 s3로의 업로드는 되는데, ec2에서 업로드 불가 문제..

 분명 똑같은 코드로 두곳인 로컬과 ec2에 배포해서 실험을 해보았다. 

 로컬에서는 s3로 업로드가 잘되는데, 왜 ec2로 배포한후에 s3로 업로드가 안되는것인지..?

 처음에는 AWS 자격 증명 설정이 문제인줄알아서, 리눅스 ec2에 aws cli를 설치후에 aws사용자 아이디와 비밀번호까지 설정해보았다.

 하지만 아이디와 비밀번호 설정때문이 아닌거같다. 왜냐하면 코드안에 직접 비밀번호와 아이디까지 넣어서 배포 하고서도 되지않았기 때 
 
 문이다. 그러면 aws와 관련된 설정문제는 아닌거같고.. 무언가 스프링 코드쪽에서 문제인거같은데..

 그렇다고 로컬에서는 돌아가는데..왜 ec2에서만..그러는지..딱히 문제될곳이 없어보이는데..원인을 계속해서 못찾겠다..

### 3) 리눅스에서 톰캣 로그찍기..

로그찍는 명령어가 tail -f /톰캣설치경로/logs/catalina.out 라고해서

톰캣 설치경로는 찾아보니/var/lib/tomcat9 에 설치가되어있다.

tomcat의 log로 들어가려하면

ubuntu@ip-172-31-30-52:/var/lib/tomcat9$ cd logs
-bash: cd: logs: Permission denied

권한이 없다고 뜬다 루트계정에서만 가능하다는건가...?

tail -f /var/lib/tomcat9/logs/catalina.out
tail: cannot open '/var/lib/tomcat9/logs/catalina.out' for reading: Permission denied
tail: no files remaining

위와 같이 해도 로그를 볼수가 없어서
sudo 붙여서 
sudo tail -f /var/lib/tomcat9/logs/catalina.out

하면 톰캣유저의 비밀번호를 입력하라는데 톰캣유저를 만든적이 없고ㅠㅠ
 
어떻게 해야 실시간으로 로그를 찍어볼수있는지..
그게 tail로 알고있는데 ..

### 4) ec2 우분투의 폴더에 업로드하기

일단 ec2 우분투 폴더에 업로드하면 스프링 시큐리티에 걸려서 접근권한이 떠버린다..

프로젝트에서 파일 업로드,다운로드를 s3로 하고있지만, 프로필 사진만큼은 ec2 폴더에 업로드를 하려한다.

왜냐하면 s3 프리티어 같은경우 put과 get의 요청수에따라 과금이 발생하기때문에 특히나 프로필 사진 같은경우 

페이지마다 요청이 자주가 과금발생이 될것만 같았다.

리눅스의 폴더를 만들고 파일을 쓰거나 읽을때는 권한을 부여해야하는것 같았다.

그래서 mkdir -m 777 upload 로 폴더를 만들어 다른 프로젝트에서 업로드시 업로드가 되는데

본 프로젝트에서는 계속 스프링 시큐리티에 걸려버린다..






